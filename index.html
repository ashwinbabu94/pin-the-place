<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pin the Place!</title>
  <link rel="stylesheet" href="https://js.arcgis.com/4.28/esri/themes/light/main.css" />
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <link rel="stylesheet" href="https://unpkg.com/@esri/calcite-components/dist/calcite/calcite.css" />
  <script type="module" src="https://unpkg.com/@esri/calcite-components/dist/calcite/calcite.esm.js"></script>
  <script src="https://js.arcgis.com/4.34/"></script>
  <link rel="stylesheet" href="styles.css" />
</head>
<body style="display: flex;flex-direction: column;">    
  <header class="app-header">
    <div class="header-content">
      <div class="header-title-container">
        <div class="marker-logo">
          <svg width="32" height="32" viewBox="0 0 24 24" fill="none">
            <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" fill="currentColor"/>
          </svg>
        </div>        
        <h1 class="app-title">Pin the Place!</h1>
      </div>      
    </div>
  </header>
  <div class="timer-bar" aria-hidden="true">
    <div id="timerFill" class="timer-fill"></div>
  </div> 
  <div class="user-welcome" id="userWelcome" style="display: none;">
    <span class="welcome-text">Welcome, <span id="userNameDisplay"></span>!</span>
  </div>       
  <div id="app" class="app">
    <main id="viewDiv"></main>
  </div>

  <!-- Name Input Modal -->
  <calcite-modal id="nameModal" width-scale="s" close-button-disabled escape-disabled outside-close-disabled>
    <div slot="header">Welcome to Pin the Place!</div>
    <div slot="content">
      <div class="modal-content">
        <calcite-notice icon="user" kind="info" open>
          <div slot="message">Please enter your name to get started</div>
        </calcite-notice>
        <div style="margin-top: 16px;">
          <calcite-label>
            Your Name
            <calcite-input 
              id="nameInput" 
              type="text" 
              placeholder="Enter your name..."
              required
              validation-message="Name is required"
              scale="m"
            ></calcite-input>
          </calcite-label>
        </div>
      </div>
    </div>
    <calcite-button slot="primary" id="saveNameBtn" disabled>Start Playing</calcite-button>
  </calcite-modal>

  <!-- Accuracy Results Modal -->
  <calcite-modal id="accuracyModal" width-scale="s" close-button-disabled escape-disabled outside-close-disabled>
    <div slot="header">Result</div>
    <div slot="content">
      <div class="modal-content">
        <div class="accuracy-info">          
          <div class="distance-display">
            <span class="distance-label">How Close?</span>
            <span class="distance-value" id="modalDistance">-- km</span>
          </div>
          <div class="time-display">
            <span class="time-label">Time taken:</span>
            <span class="time-value" id="modalTime">-- seconds</span>
          </div>
          <div class="accuracy-message" id="accuracyMessage">
            ...
          </div>
        </div>
      </div>
    </div>
    <!-- <calcite-button slot="primary" id="nextRoundBtn">Next Round</calcite-button> -->
    <calcite-button slot="primary" id="retryBtn">Retry</calcite-button>
  </calcite-modal>

    <!-- Accuracy Results Modal -->
  <calcite-modal id="timeoverModal" width-scale="s" close-button-disabled escape-disabled outside-close-disabled>
    <div slot="header">Time Over!</div>
    <div slot="content">
      <div class="modal-content">
        <div class="accuracy-info">
          <div class="accuracy-message" id="accuracyMessage">
            Wait for next round!
          </div>
        </div>
      </div>
    </div>
  </calcite-modal>

  <calcite-modal id="maxAttemptModal" width-scale="s" close-button-disabled escape-disabled outside-close-disabled>
    <div slot="header">Maximum attempts exceeded!</div>
    <div slot="content">
      <div class="modal-content">
        <div class="accuracy-info">
          <div class="accuracy-message" id="accuracyMessage">
            Wait for next round!
          </div>
        </div>
      </div>
    </div>
  </calcite-modal>

  <!-- Load the application module which will dynamically import the ArcGIS API -->
  <script type="module" src="app.js"></script>
</body>
</html>
